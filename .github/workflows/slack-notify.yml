name: Slack Notify
on:
  workflow_call:
    inputs:
      status:
        required: true
        type: string
      environment:
        required: true
        type: string
      message:
        required: true
        type: string
      WEBHOOK_PATH:
        required: true
        type: string
jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Slack Notification
        uses: rtCamp/action-slack-notify@v2
        env:
          SLACK_WEBHOOK: https://hooks.slack.com/services/${{ inputs.WEBHOOK_PATH }}
          SLACK_USERNAME: TerragruntBot
          SLACK_TITLE: Terragrunt Apply ${{ inputs.status }} - ${{ inputs.environment }}
          SLACK_COLOR: ${{ inputs.status == 'Success' && 'good' || 'danger' }}
          SLACK_MESSAGE: ${{ inputs.message }}
